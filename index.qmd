---
execute:
    echo: false
---
## Introduction
Due to increase of tariff by the Trump administration took effect on 6/4/2025 (50% on steel, 25% on aluminum, 25% on all imported automobiles and auto parts) which would lead to increase in price of automobiles in the long run (especially those from outside of US) could already have impact of sale of new car in the US.  Using auto sales data for various models including domestic and international auto maker from https://www.goodcarbadcar.net/2025-u-s-auto-sales-figures-by-model-all-vehicle-ranked/, graph was created to demonstrate whether number of auto sales was affected by the increase of tariff.  The graphs are showing that there are noticeable decline of auto sales in month of June, 2025 for most of the models.


```{r}
#| message: false
#| warning: false
library(tidyverse)
library(scales)
source("load_auto_sales_data.R")
vline_date <- as.Date("2025-06-05")
All |> 
    filter(Year %in% c(2023, 2024, 2025)) |> 
    filter(Sale != 0) |> 
    ggplot(aes(x=Date, y=Sale, color=Model)) + 
    geom_line() + 
      geom_vline(xintercept = as.numeric(vline_date), linetype = "dashed", color = "black") +
        annotate("text",
           x = vline_date,
           y = max(All$Sale, na.rm = TRUE) * 0.95,  # 95% of max y for better placement
           label = "Tariff imposed",
           angle = 90,
           vjust = -0.5,
           hjust = 0,
           size = 3.5) +
scale_y_continuous(labels = label_comma()) + scale_x_date(date_labels = "%b/%y", date_breaks = "2 months")  + labs(title="Auto Sales in US (By Model)", x="Month", y='Number of cars sold', caption='Data Source: https://www.goodcarbadcar.net/')
```
```{r}
#| message: false
#| warning: false
monthly_sales_by_country <- All |>
  group_by(Country, Date, Year) |>
  summarise(Total_Sale = sum(Sale, na.rm = TRUE), .groups = "drop")

monthly_sales_by_country |>
    filter(Year %in% c(2023, 2024, 2025)) |> 
    filter(Total_Sale != 0) |> 
    ggplot(aes(x=Date, y=Total_Sale, color=Country)) + 
    geom_line() + 
      geom_vline(xintercept = as.numeric(vline_date), linetype = "dashed", color = "black") +
        annotate("text",
           x = vline_date,
           y = max(monthly_sales_by_country$Total_Sale, na.rm = TRUE) * 0.95,  # 95% of max y for better placement
           label = "Tariff imposed",
           angle = 90,
           vjust = -0.5,
           hjust = 0,
           size = 3.5) +
scale_y_continuous(labels = label_comma()) + 
scale_x_date(date_labels = "%b/%y", date_breaks = "2 months")  + 
labs(title="Auto Sales in US (By Country)", x="Month", y='Number of cars sold', caption='Data Source: https://www.goodcarbadcar.net/')
```

```{r}
#| message: false
#| warning: false
All |> 
    filter(Year %in% c(2025)) |> 
    filter(Sale != 0) |> 
    ggplot(aes(x = Date, y = Ratio_From_Prev_Year)) +
    geom_line(color = "steelblue") +
      geom_vline(xintercept = as.numeric(vline_date), linetype = "dashed", color = "black") +
        annotate("text",
           x = vline_date,
           y = max(All$Ratio_From_Prev_Year, na.rm = TRUE) * 0.95,  # 95% of max y for better placement
           label = "Tariff imposed",
           angle = 90,
           vjust = -0.5,
           hjust = 0,
           size = 3.5) +
    facet_wrap(~ Model, scales = "free_y") +
    scale_y_continuous(labels = label_percent(accuracy = 1)) +
    labs(
        title = "Comparison of cars sold for individual model (2024 to 2025)",
        x = "Month (2025)",
        y = "Percentage of cars sold",
        caption = "Data Source: https://www.goodcarbadcar.net/"
     ) +
  theme_minimal()
```


```{r}
#| message: false
#| warning: false
monthly_Ration_by_country <- All |>
  group_by(Country, Date, Year) |>
  summarise(Ratio_By_Country = sum(Sale, na.rm = TRUE) / sum(Sale_prev_year, na.rm = TRUE), .groups = "drop")

monthly_Ration_by_country |>
    filter(Year %in% c(2025)) |> 
    filter(Ratio_By_Country != 0) |> 
    ggplot(aes(x=Date, y=Ratio_By_Country, color=Country)) + 
    geom_line() + 
      geom_vline(xintercept = as.numeric(vline_date), linetype = "dashed", color = "black") +
        annotate("text",
           x = vline_date,
           y = max(monthly_Ration_by_country$Ratio_By_Country, na.rm = TRUE) * 0.95,  # 95% of max y for better placement
           label = "Tariff imposed",
           angle = 90,
           vjust = -0.5,
           hjust = 0,
           size = 3.5) +
    scale_y_continuous(labels = label_percent(accuracy = 1)) +
scale_y_continuous(labels = label_comma()) + 
scale_x_date(date_labels = "%b/%y", date_breaks = "2 months")  + 
labs(
        title = "Comparison of cars sold by country (2024 to 2025)",
        x = "Month (2025)",
        y = "Percentage of cars sold",
        caption = "Data Source: https://www.goodcarbadcar.net/"
     ) 
```